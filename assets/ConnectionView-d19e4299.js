import{_ as P,n as $,r as l,q as b,o,c as r,a as s,e as j,s as w,w as E,v as V,g as f,F as q,A as L,x as B,p as Z,f as T,d as z,y as D}from"./index-85a56c2e.js";const i=_=>(Z("data-v-28731282"),_=_(),T(),_),G=i(()=>s("h3",null,[z(" En cours en local, le form fonctionne, les validations et l'authentification aussi. "),s("br"),s("br"),z(" Vous pouvez vous connecter avec l'email "),s("strong",null,"test@test.fr"),z(" et le mot de passe "),s("strong",null,"12345")],-1)),H={class:"tabs"},J=i(()=>s("span",{class:"border-tab"},null,-1)),K=i(()=>s("label",{for:"email"},"Email :",-1)),O={key:0,class:"error-message"},Q={key:1,class:"error-message"},R=i(()=>s("label",{for:"password"},"Mot de passe :",-1)),W={key:0,class:"error-message"},X=i(()=>s("span",null,"Minimum 2 caractères",-1)),Y=i(()=>s("br",null,null,-1)),ee=i(()=>s("span",null,"j'aurais pu faire ca:",-1)),se=i(()=>s("br",null,null,-1)),ae=i(()=>s("span",null,"/(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-\\s]).{8,}$/",-1)),te=[X,Y,ee,se,ae],ne={key:0},le=i(()=>s("label",{for:"password2"},"Confirmer le mot de passe :",-1)),oe={key:0,class:"error-message"},ie=["disabled"],ue=["disabled"],re={key:3,class:"error-message"},ce={__name:"ConnectionForm",setup(_){const y=$(),n=l("test2@test.fr"),u=l("aaaa"),v=l(""),m=l(!1),h=l(!1),g=l(!1),p=l(!0),c=l(!1),d=l(!0),x=l(!1),M=l(!1);b(n,e=>{C(e)}),b(u,e=>{e.length>0&&S(e)}),b([u,v],e=>{e[1].length>0&&F(e)}),b([n,u],()=>{k(n)}),b([n,u,v],()=>{k(n)});async function k(e){await U(e.value),p.value===!0&&!m.value&&e.value.length>1&&!h.value&&u.value.length>1||c.value===!0&&!x.value&&!m.value&&e.value.length>1&&!h.value&&u.value.length>1&&!g.value&&v.value.length>1?d.value=!1:d.value=!0}function A(e){this.unknowUser=!1,e!==void 0&&(e.id==="connection"?(p.value=!0,c.value=!1):e.id==="subscribe"&&(c.value=!0,p.value=!1)),k(n),c.value&&U(n.value)}async function C(e){return c.value&&await U(e),/[A-Za-z0-9._%-]+@[A-Za-z0-9._%-]+\.[a-z]{2,}/.test(e)?(m.value=!1,!0):(m.value=!0,!1)}async function U(e){return await L.post("/api/users/isemailused",{email:e}).then(a=>{x.value=a.data.resp}).catch(a=>console.log("erreur axios isEmailUsed:",a))}function S(e){return e.length>1?(h.value=!1,!0):(h.value=!0,!1)}function F(e){return e[0]===e[1]?(g.value=!1,!0):(g.value=!0,!1)}async function I(e,a,t){this.unknowUser=!1,p.value?C(e)&&S(a)&&y.login(e,a).then(N=>{B.push({name:"admin"})},N=>{this.unknowUser=!0}):C(e)&&S(a)&&F([a,t])&&y.signup(e,a).then(()=>{B.push({name:"admin"})})}return(e,a)=>(o(),r(q,null,[G,s("div",null,[s("form",{onSubmit:a[5]||(a[5]=j(t=>I(n.value,u.value,v.value),["prevent"]))},[s("div",H,[s("p",{class:w(["tab",[p.value?"active":"unactive"]]),id:"connection",onClick:a[0]||(a[0]=t=>A(t.target))}," Connexion ",2),J,s("p",{class:w(["tab",[c.value?"active":"unactive"]]),id:"subscribe",onClick:a[1]||(a[1]=t=>A(t.target))}," Inscription ",2)]),s("div",null,[K,E(s("input",{type:"email",name:"email",id:"email","onUpdate:modelValue":a[2]||(a[2]=t=>n.value=t),placeholder:"Saisissez votre mail"},null,512),[[V,n.value]]),m.value?(o(),r("p",O,"Le mail est mal formé, ex: xx@xx.xx")):f("",!0),x.value&&c.value?(o(),r("p",Q," Le mail est déjà utilisé ")):f("",!0)]),s("div",null,[R,E(s("input",{type:"password",name:"password",id:"password","onUpdate:modelValue":a[3]||(a[3]=t=>u.value=t),placeholder:"Saisissez votre mot de passe"},null,512),[[V,u.value]]),h.value?(o(),r("p",W,te)):f("",!0)]),c.value?(o(),r("div",ne,[le,E(s("input",{type:"password",name:"password2",id:"password2","onUpdate:modelValue":a[4]||(a[4]=t=>v.value=t),placeholder:"Confirmer votre mot de passe"},null,512),[[V,v.value]]),g.value?(o(),r("p",oe," Les mots de passe ne sont pas identiques ")):f("",!0)])):f("",!0),p.value?(o(),r("button",{key:1,disabled:d.value,class:w(["button",d.value?"disabled":""]),type:"submit"}," Se connecter ",10,ie)):(o(),r("button",{key:2,class:w(["button",d.value?"disabled":""]),disabled:d.value}," S'inscrire ",10,ue)),M.value?(o(),r("p",re," Nous n'avons pas pu vous identifier ")):f("",!0)],32)])],64))}},de=P(ce,[["__scopeId","data-v-28731282"]]),pe={__name:"ConnectionView",setup(_){return(y,n)=>(o(),D(de))}};export{pe as default};
